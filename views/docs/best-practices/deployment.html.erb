<div class="docs">
  <div class="full-width">
    <div class="two-third">
<h1 id="best-practices-deployment"><a class="toclink" href="#best-practices-deployment"><a href="/docs/best-practices">Best Practices</a> &gt; Deployment</a></h1>
<div class="toc">
<ul>
<li><a href="#best-practices-deployment">Best Practices &gt; Deployment</a><ul>
<li><a href="#deploying-to-heroku">Deploying to Heroku</a></li>
<li><a href="#deploying-to-the-clouda-vpsbare-metal">Deploying to the cloud/a VPS/bare metal</a><ul>
<li><a href="#upstart">Upstart</a></li>
<li><a href="#monitoring">Monitoring</a></li>
<li><a href="#versioning">Versioning</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>Adhearsion can be deployed any way you like, but here are some guidelines to make the process easier. These will evolve over time:</p>
<h2 id="deploying-to-heroku"><a class="toclink" href="#deploying-to-heroku">Deploying to Heroku</a></h2>
<p>Heroku is the current preferred deployment environment, because of the simplicity with which applications may be deployed there.</p>
<p>The first step is to generate an Adhearsion application:</p>
<pre class="terminal">

$ gem install --pre adhearsion
Successfully installed adhearsion-2.0.0.rc5
1 gem installed
$ ahn create myapp
<span class="ansi1"><span class="ansi32">      create</span></span>  config
<span class="ansi1"><span class="ansi32">      create</span></span>  config/adhearsion.rb
<span class="ansi1"><span class="ansi32">      create</span></span>  config/environment.rb
<span class="ansi1"><span class="ansi32">      create</span></span>  lib
<span class="ansi1"><span class="ansi32">      create</span></span>  lib/simon_game.rb
<span class="ansi1"><span class="ansi32">      create</span></span>  script
<span class="ansi1"><span class="ansi32">      create</span></span>  script/ahn
<span class="ansi1"><span class="ansi32">      create</span></span>  spec
<span class="ansi1"><span class="ansi32">      create</span></span>  spec/spec_helper.rb
<span class="ansi1"><span class="ansi32">      create</span></span>  spec/call_controllers
<span class="ansi1"><span class="ansi32">      create</span></span>  spec/support
<span class="ansi1"><span class="ansi32">      create</span></span>  Gemfile
<span class="ansi1"><span class="ansi32">      create</span></span>  .gitignore
<span class="ansi1"><span class="ansi32">      create</span></span>  .rspec
<span class="ansi1"><span class="ansi32">      create</span></span>  Procfile
<span class="ansi1"><span class="ansi32">      create</span></span>  Rakefile
<span class="ansi1"><span class="ansi32">      create</span></span>  README.md
<span class="ansi1"><span class="ansi32">       chmod</span></span>  script/ahn
$ cd myapp
</pre>

<p>We must then bundle the required gems, and thus create a Gemfile.lock:</p>
<pre class="terminal">

$ bundle install
Fetching gem metadata from http://rubygems.org/.........
Fetching gem metadata from http://rubygems.org/..
Using rake (0.9.2.2)
Using i18n (0.6.0)
Using multi_json (1.2.0)
Using activesupport (3.2.3)
Using adhearsion-loquacious (1.9.2)
Using bundler (1.1.3)
Using celluloid (0.10.0)
Using countdownlatch (1.0.0)
Using deep_merge (1.0.0)
Using ffi (1.0.11)
Using future-resource (1.0.0)
Using connection_pool (0.1.0)
Using girl_friday (0.9.7)
Using systemu (2.5.0)
Using macaddr (1.5.0)
Using uuid (2.3.5)
Using has-guarded-handlers (1.2.0)
Using json (1.6.6)
Using little-plugger (1.1.3)
Using logging (1.7.2)
Using coderay (1.0.6)
Using method_source (0.7.1)
Using slop (2.4.4)
Using pry (0.9.8.4)
Using eventmachine (0.12.10)
Using nokogiri (1.4.7)
Using niceogiri (1.0.1)
Using blather (0.7.0)
Using uuidtools (2.1.2)
Using ruby_ami (1.0.0)
Using ruby_speech (1.0.0)
Using state_machine (1.1.2)
Using punchblock (0.12.0)
Using thor (0.14.6)
Using adhearsion (2.0.0.rc5)
<span class="ansi32">Your bundle is complete! Use `bundle show [gemname]` to see where a bundled gem is installed.</span>
$ bundle package
Using rake (0.9.2.2)
Using i18n (0.6.0)
Using multi_json (1.2.0)
Using activesupport (3.2.3)
Using adhearsion-loquacious (1.9.2)
Using bundler (1.1.3)
Using celluloid (0.10.0)
Using countdownlatch (1.0.0)
Using deep_merge (1.0.0)
Using ffi (1.0.11)
Using future-resource (1.0.0)
Using connection_pool (0.1.0)
Using girl_friday (0.9.7)
Using systemu (2.5.0)
Using macaddr (1.5.0)
Using uuid (2.3.5)
Using has-guarded-handlers (1.2.0)
Using json (1.6.6)
Using little-plugger (1.1.3)
Using logging (1.7.2)
Using coderay (1.0.6)
Using method_source (0.7.1)
Using slop (2.4.4)
Using pry (0.9.8.4)
Using eventmachine (0.12.10)
Using nokogiri (1.4.7)
Using niceogiri (1.0.1)
Using blather (0.7.0)
Using uuidtools (2.1.2)
Using ruby_ami (1.0.0)
Using ruby_speech (1.0.0)
Using state_machine (1.1.2)
Using punchblock (0.12.0)
Using thor (0.14.6)
Using adhearsion (2.0.0.rc5)
<span class="ansi32">Your bundle is complete! Use `bundle show [gemname]` to see where a bundled gem is installed.</span>
Updating .gem files in vendor/cache
  * rake-0.9.2.2.gem
  * i18n-0.6.0.gem
  * multi_json-1.2.0.gem
  * activesupport-3.2.3.gem
  * adhearsion-loquacious-1.9.2.gem
  * celluloid-0.10.0.gem
  * countdownlatch-1.0.0.gem
  * deep_merge-1.0.0.gem
  * ffi-1.0.11.gem
  * future-resource-1.0.0.gem
  * connection_pool-0.1.0.gem
  * girl_friday-0.9.7.gem
  * systemu-2.5.0.gem
  * macaddr-1.5.0.gem
  * uuid-2.3.5.gem
  * has-guarded-handlers-1.2.0.gem
  * json-1.6.6.gem
  * little-plugger-1.1.3.gem
  * logging-1.7.2.gem
  * coderay-1.0.6.gem
  * method_source-0.7.1.gem
  * slop-2.4.4.gem
  * pry-0.9.8.4.gem
  * eventmachine-0.12.10.gem
  * nokogiri-1.4.7.gem
  * niceogiri-1.0.1.gem
  * blather-0.7.0.gem
  * uuidtools-2.1.2.gem
  * ruby_ami-1.0.0.gem
  * ruby_speech-1.0.0.gem
  * state_machine-1.1.2.gem
  * punchblock-0.12.0.gem
  * thor-0.14.6.gem
  * adhearsion-2.0.0.rc5.gem
$ gem install heroku
Successfully installed heroku-2.24.0
1 gem installed
</pre>

<p>All applications deployed to Heroku must live in a git repository, so create one and commit your code:</p>
<pre class="terminal">

$ git init
Initialized empty Git repository in /Users/ben/code/VoIP/adhearsion/website/docs/artifacts/a640eaac4db76df88782f680962d799b/source/best-practices/myapp/.git/
$ git add .
$ git commit -a -m "Initial commit"
[master (root-commit) b1bb9f1] Initial commit
 46 files changed, 306 insertions(+)
 create mode 100644 .gitignore
 create mode 100644 .rspec
 create mode 100644 Gemfile
 create mode 100644 Gemfile.lock
 create mode 100644 Procfile
 create mode 100644 README.md
 create mode 100644 Rakefile
 create mode 100644 config/adhearsion.rb
 create mode 100644 config/environment.rb
 create mode 100644 lib/simon_game.rb
 create mode 100755 script/ahn
 create mode 100644 spec/spec_helper.rb
 create mode 100644 vendor/cache/activesupport-3.2.3.gem
 create mode 100644 vendor/cache/adhearsion-2.0.0.rc5.gem
 create mode 100644 vendor/cache/adhearsion-loquacious-1.9.2.gem
 create mode 100644 vendor/cache/blather-0.7.0.gem
 create mode 100644 vendor/cache/celluloid-0.10.0.gem
 create mode 100644 vendor/cache/coderay-1.0.6.gem
 create mode 100644 vendor/cache/connection_pool-0.1.0.gem
 create mode 100644 vendor/cache/countdownlatch-1.0.0.gem
 create mode 100644 vendor/cache/deep_merge-1.0.0.gem
 create mode 100644 vendor/cache/eventmachine-0.12.10.gem
 create mode 100644 vendor/cache/ffi-1.0.11.gem
 create mode 100644 vendor/cache/future-resource-1.0.0.gem
 create mode 100644 vendor/cache/girl_friday-0.9.7.gem
 create mode 100644 vendor/cache/has-guarded-handlers-1.2.0.gem
 create mode 100644 vendor/cache/i18n-0.6.0.gem
 create mode 100644 vendor/cache/json-1.6.6.gem
 create mode 100644 vendor/cache/little-plugger-1.1.3.gem
 create mode 100644 vendor/cache/logging-1.7.2.gem
 create mode 100644 vendor/cache/macaddr-1.5.0.gem
 create mode 100644 vendor/cache/method_source-0.7.1.gem
 create mode 100644 vendor/cache/multi_json-1.2.0.gem
 create mode 100644 vendor/cache/niceogiri-1.0.1.gem
 create mode 100644 vendor/cache/nokogiri-1.4.7.gem
 create mode 100644 vendor/cache/pry-0.9.8.4.gem
 create mode 100644 vendor/cache/punchblock-0.12.0.gem
 create mode 100644 vendor/cache/rake-0.9.2.2.gem
 create mode 100644 vendor/cache/ruby_ami-1.0.0.gem
 create mode 100644 vendor/cache/ruby_speech-1.0.0.gem
 create mode 100644 vendor/cache/slop-2.4.4.gem
 create mode 100644 vendor/cache/state_machine-1.1.2.gem
 create mode 100644 vendor/cache/systemu-2.5.0.gem
 create mode 100644 vendor/cache/thor-0.14.6.gem
 create mode 100644 vendor/cache/uuid-2.3.5.gem
 create mode 100644 vendor/cache/uuidtools-2.1.2.gem
</pre>

<p>Now we can create the Heroku application, taking care to specify the target stack as 'cedar'.</p>
<pre class="terminal">

$ heroku apps:create --stack cedar
Creating freezing-leaf-5202... done, stack is cedar
http://freezing-leaf-5202.herokuapp.com/ | git@heroku.com:freezing-leaf-5202.git
Git remote heroku added
</pre>

<p>Including sensitive data in a repository is bad practice, so we keep our Punchblock credentials in the environment on Heroku, as so:</p>
<pre class="terminal">

$ heroku config:add AHN_PUNCHBLOCK_USERNAME=foo@bar.com AHN_PUNCHBLOCK_USERNAME=foobar
Adding config vars and restarting app... done, v2
  AHN_PUNCHBLOCK_USERNAME =&gt; foobar
</pre>

<p>We're now ready to push the application to Heroku, which is very simple:</p>
<pre class="terminal">

$ git push heroku master
Counting objects: 54, done.
Delta compression using up to 4 threads.
Compressing objects:   2% (1/48)  Compressing objects:   4% (2/48)  Compressing objects:   6% (3/48)  Compressing objects:   8% (4/48)  Compressing objects:  10% (5/48)  Compressing objects:  12% (6/48)  Compressing objects:  14% (7/48)  Compressing objects:  16% (8/48)  Compressing objects:  18% (9/48)  Compressing objects:  20% (10/48)  Compressing objects:  22% (11/48)  Compressing objects:  25% (12/48)  Compressing objects:  27% (13/48)  Compressing objects:  29% (14/48)  Compressing objects:  31% (15/48)  Compressing objects:  33% (16/48)  Compressing objects:  35% (17/48)  Compressing objects:  37% (18/48)  Compressing objects:  39% (19/48)  Compressing objects:  41% (20/48)  Compressing objects:  43% (21/48)  Compressing objects:  45% (22/48)  Compressing objects:  47% (23/48)  Compressing objects:  50% (24/48)  Compressing objects:  52% (25/48)  Compressing objects:  54% (26/48)  Compressing objects:  56% (27/48)  Compressing objects:  58% (28/48)  Compressing objects:  60% (29/48)  Compressing objects:  62% (30/48)  Compressing objects:  64% (31/48)  Compressing objects:  66% (32/48)  Compressing objects:  68% (33/48)  Compressing objects:  70% (34/48)  Compressing objects:  72% (35/48)  Compressing objects:  75% (36/48)  Compressing objects:  77% (37/48)  Compressing objects:  79% (38/48)  Compressing objects:  81% (39/48)  Compressing objects:  83% (40/48)  Compressing objects:  85% (41/48)  Compressing objects:  87% (42/48)  Compressing objects:  89% (43/48)  Compressing objects:  91% (44/48)  Compressing objects:  93% (45/48)  Compressing objects:  95% (46/48)  Compressing objects:  97% (47/48)  Compressing objects: 100% (48/48)  Compressing objects: 100% (48/48), done.
Writing objects:   1% (1/54)  Writing objects:   3% (2/54)  Writing objects:   5% (3/54)  Writing objects:   7% (4/54)  Writing objects:   9% (5/54)  Writing objects:  11% (6/54)  Writing objects:  12% (7/54)  Writing objects:  14% (8/54)  Writing objects:  16% (9/54)  Writing objects:  18% (10/54)  Writing objects:  20% (11/54)  Writing objects:  22% (12/54)  Writing objects:  24% (13/54)  Writing objects:  25% (14/54)  Writing objects:  27% (15/54)  Writing objects:  29% (16/54)  Writing objects:  31% (17/54)  Writing objects:  33% (18/54)  Writing objects:  35% (19/54)  Writing objects:  37% (20/54)  Writing objects:  37% (20/54), 160.00 KiB | 147 KiB/s  Writing objects:  38% (21/54), 160.00 KiB | 147 KiB/s  Writing objects:  38% (21/54), 304.00 KiB | 134 KiB/s  Writing objects:  40% (22/54), 304.00 KiB | 134 KiB/s  Writing objects:  42% (23/54), 384.00 KiB | 128 KiB/s  Writing objects:  42% (23/54), 472.00 KiB | 127 KiB/s  Writing objects:  42% (23/54), 552.00 KiB | 127 KiB/s  Writing objects:  44% (24/54), 616.00 KiB | 122 KiB/s  Writing objects:  46% (25/54), 616.00 KiB | 122 KiB/s  Writing objects:  46% (25/54), 696.00 KiB | 121 KiB/s  Writing objects:  48% (26/54), 696.00 KiB | 121 KiB/s  Writing objects:  50% (27/54), 696.00 KiB | 121 KiB/s  Writing objects:  51% (28/54), 696.00 KiB | 121 KiB/s  Writing objects:  53% (29/54), 696.00 KiB | 121 KiB/s  Writing objects:  53% (29/54), 776.00 KiB | 121 KiB/s  Writing objects:  53% (29/54), 856.00 KiB | 120 KiB/s  Writing objects:  55% (30/54), 936.00 KiB | 116 KiB/s  Writing objects:  55% (30/54), 1024.00 KiB | 115 KiB/s  Writing objects:  55% (30/54), 1.08 MiB | 117 KiB/s  Writing objects:  55% (30/54), 1.22 MiB | 112 KiB/s  Writing objects:  55% (30/54), 1.30 MiB | 116 KiB/s  Writing objects:  55% (30/54), 1.45 MiB | 116 KiB/s  Writing objects:  55% (30/54), 1.54 MiB | 116 KiB/s  Writing objects:  55% (30/54), 1.68 MiB | 114 KiB/s  Writing objects:  57% (31/54), 1.68 MiB | 114 KiB/s  Writing objects:  59% (32/54), 1.68 MiB | 114 KiB/s  Writing objects:  59% (32/54), 1.76 MiB | 113 KiB/s  Writing objects:  61% (33/54), 1.76 MiB | 113 KiB/s  Writing objects:  62% (34/54), 1.76 MiB | 113 KiB/s  Writing objects:  64% (35/54), 1.84 MiB | 116 KiB/s  Writing objects:  64% (35/54), 1.91 MiB | 112 KiB/s  Writing objects:  64% (35/54), 1.99 MiB | 112 KiB/s  Writing objects:  66% (36/54), 1.99 MiB | 112 KiB/s  Writing objects:  68% (37/54), 1.99 MiB | 112 KiB/s  Writing objects:  68% (37/54), 2.07 MiB | 113 KiB/s  Writing objects:  70% (38/54), 2.07 MiB | 113 KiB/s  Writing objects:  72% (39/54), 2.07 MiB | 113 KiB/s  Writing objects:  74% (40/54), 2.07 MiB | 113 KiB/s  Writing objects:  75% (41/54), 2.07 MiB | 113 KiB/s  Writing objects:  77% (42/54), 2.07 MiB | 113 KiB/s  Writing objects:  77% (42/54), 2.21 MiB | 111 KiB/s  Writing objects:  77% (42/54), 2.29 MiB | 105 KiB/s  Writing objects:  79% (43/54), 2.29 MiB | 105 KiB/s  Writing objects:  79% (43/54), 2.37 MiB | 107 KiB/s  Writing objects:  81% (44/54), 2.37 MiB | 107 KiB/s  Writing objects:  83% (45/54), 2.45 MiB | 108 KiB/s  Writing objects:  83% (45/54), 2.53 MiB | 109 KiB/s  Writing objects:  85% (46/54), 2.53 MiB | 109 KiB/s  Writing objects:  85% (46/54), 2.61 MiB | 113 KiB/s  Writing objects:  87% (47/54), 2.61 MiB | 113 KiB/s  Writing objects:  88% (48/54), 2.61 MiB | 113 KiB/s  Writing objects:  90% (49/54), 2.68 MiB | 112 KiB/s  Writing objects:  90% (49/54), 2.75 MiB | 111 KiB/s  Writing objects:  90% (49/54), 2.89 MiB | 106 KiB/s  Writing objects:  90% (49/54), 3.05 MiB | 115 KiB/s  Writing objects:  92% (50/54), 3.05 MiB | 115 KiB/s  Writing objects:  94% (51/54), 3.05 MiB | 115 KiB/s  Writing objects:  96% (52/54), 3.13 MiB | 117 KiB/s  Writing objects:  98% (53/54), 3.13 MiB | 117 KiB/s  Writing objects: 100% (54/54), 3.13 MiB | 117 KiB/s  Writing objects: 100% (54/54), 3.15 MiB | 117 KiB/s, done.
Total 54 (delta 0), reused 0 (delta 0)

-----&gt; Heroku receiving push
-----&gt; Ruby/Rails app detected
-----&gt; Installing dependencies using Bundler version 1.1.2
       Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment
       Installing rake (0.9.2.2)
       Installing i18n (0.6.0)
       Installing multi_json (1.2.0)
       Installing activesupport (3.2.3)
       Installing adhearsion-loquacious (1.9.2)
       Using bundler (1.1.2)
       Installing celluloid (0.10.0)
       Installing countdownlatch (1.0.0)
       Installing deep_merge (1.0.0)
       Installing ffi (1.0.11) with native extensions
       Installing future-resource (1.0.0)
       Installing connection_pool (0.1.0)
       Installing girl_friday (0.9.7)
       Installing systemu (2.5.0)
       Installing macaddr (1.5.0)
       Installing uuid (2.3.5)
       Installing has-guarded-handlers (1.2.0)
       Installing json (1.6.6) with native extensions
       Installing little-plugger (1.1.3)
       Installing logging (1.7.2)
       Installing coderay (1.0.6)
       Installing method_source (0.7.1)
       Installing slop (2.4.4)
       Installing pry (0.9.8.4)
       Installing eventmachine (0.12.10) with native extensions
       Installing nokogiri (1.4.7) with native extensions
       Installing niceogiri (1.0.1)
       Installing blather (0.7.0)
       Installing uuidtools (2.1.2)
       Installing ruby_ami (1.0.0)
       Installing ruby_speech (1.0.0)
       Installing state_machine (1.1.2)
       Installing punchblock (0.12.0)
       Installing thor (0.14.6)
       Installing adhearsion (2.0.0.rc5)
       Updating .gem files in vendor/cache
       Your bundle is complete! It was installed into ./vendor/bundle
       Cleaning up the bundler cache.
-----&gt; Writing config/database.yml to read from DATABASE_URL
-----&gt; Rails plugin injection
       Injecting rails_log_stdout
-----&gt; Discovering process types
       Procfile declares types      -&gt; ahn
       Default types for Ruby/Rails -&gt; console, rake, web, worker
-----&gt; Compiled slug size is 8.9MB
-----&gt; Launching... done, v5
       http://freezing-leaf-5202.herokuapp.com deployed to Heroku

To git@heroku.com:freezing-leaf-5202.git
 * [new branch]      master -&gt; master
</pre>

<p>Once the application is resident on Heroku, we can appropriately scale the number of processes and watch our application boot.</p>
<pre class="terminal">

$ heroku ps:scale ahn=1 web=0
Scaling ahn processes... done, now running 1
Scaling web processes... done, now running 0
</pre>

<h2 id="deploying-to-the-clouda-vpsbare-metal"><a class="toclink" href="#deploying-to-the-clouda-vpsbare-metal">Deploying to the cloud/a VPS/bare metal</a></h2>
<h3 id="upstart"><a class="toclink" href="#upstart">Upstart</a></h3>
<h3 id="monitoring"><a class="toclink" href="#monitoring">Monitoring</a></h3>
<h3 id="versioning"><a class="toclink" href="#versioning">Versioning</a></h3>
<p><a href="#" rel="docs-nav-active" style="display:none;">docs-nav-best-practices</a></p>
<div class='docs-progress-nav'>
  <span class='back'>
    Back to <a href="/docs/best-practices/testing">Testing</a>
  </span>
</div>
    </div>

    <div class="one-third">
      <div class="outer-rounded-box-bold">
        <div class="inner-rounded-box-filled-grey clearfix">
          <h3>Documentation</h3>
          <ul class="collapsibleList">
            <li id="docs-nav-getting-started">
              Getting Started
              <ul>
                <li id="docs-nav-getting-started-prerequisites"><a href="/docs/getting-started/prerequisites">Prerequisites</a></li>
                <li id="docs-nav-getting-started-installation"><a href="/docs/getting-started/installation">Installation</a></li>
              </ul>
            </li>
            <li id="docs-nav-console"><a href="/docs/console">Console</a></li>
            <li id="docs-nav-call-controller"><a href="/docs/call-controllers">Call Controllers</a></li>
            <li id="docs-nav-routing"><a href="/docs/routing">Routing</a></li>
            <li id="docs-nav-config"><a href="/docs/config">Config</a></li>
            <li id="docs-nav-config"><a href="/docs/events">Events</a></li>
            <li id="docs-nav-logging"><a href="/docs/logging">Logging</a></li>
            <li id="docs-nav-plugins"><a href="/docs/plugins">Plugins</a></li>
            <li id="docs-nav-best-practices">
              Best Practices
              <ul>
                <li id="docs-nav-best-practices-testing"><a href="/docs/best-practices/testing">Testing</a></li>
                <li id="docs-nav-best-practices-deployment"><a href="/docs/best-practices/deployment">Deployment</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="clear"></div>
  </div>
</div>

<a href="#" id="main-nav-active" style="display:none;">#main-nav-docs</a>